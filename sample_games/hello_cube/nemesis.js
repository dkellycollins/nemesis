/*! nemesis 2014-12-09 */
define("eventObject",["require","exports"],function(){var a=function(){function a(){this._events={}}return a.prototype.registerEvent=function(a){this._events[a]=[]},a.prototype.on=function(a,b){this._events[a].push(b)},a.prototype.emit=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];this._events[a].forEach(function(a){a(b)})},a}();return a}),define("nemesis.util/logger/consoleLogger",["require","exports"],function(){var a;return function(a){function b(a){e>d||console.log(a)}function c(a,c){e>d||(console.error(a),c&&console.error(c.toString()),e++,e>d&&b("Max errors reached. Disabling log."))}var d=500,e=0;a.log=b,a.logError=c}(a||(a={})),a}),define("canvas",["require","exports","nemesis.util/logger/consoleLogger"],function(a,b,c){var d,e=document.getElementsByTagName("canvas");if(0==e.length)c.logError("No canvas elements found.");else{for(var f=0;f<e.length;f++)if(e[f].hasAttribute("nemesis")){d=e[f];break}d=d||e[0],"true"==d.getAttribute("fullscreen")&&(d.height=window.innerHeight,d.width=window.innerWidth)}return d}),define("nemesis.input/keyboard",["require","exports","../canvas"],function(a,b,c){var d;return function(a){function b(a){return!!f[a]}function d(a){f[a.code]=!1}function e(a){f[a.code]=!0}var f={};a.getKey=b,c.addEventListener("keyup",d,!1),c.addEventListener("keydown",e,!1)}(d||(d={})),d}),define("nemesis.input/mouse",["require","exports","../canvas"],function(a,b,c){var d;return function(a){function b(a){return i[a]}function d(a){i[a.button]=!0}function e(a){i[a.button]=!1}function f(){a.posX=0,a.posY=0;for(var b in i)i[b]=!1}function g(b){a.posX=b.clientX,a.posY=b.clientY;for(var c in b.buttons)i[c]=!0}function h(b){a.posX=b.clientX,a.posY=b.clientY}a.posX=0,a.posY=0;var i={};a.getButton=b,c.addEventListener("mousedown",d,!1),c.addEventListener("mouseup",e,!1),c.addEventListener("mouseout",f,!1),c.addEventListener("mouseenter",g,!1),c.addEventListener("mousemove",h,!1)}(d||(d={})),d}),define("nemesis.input/mouseButtons",["require","exports"],function(){var a;return function(a){a.LEFT=0,a.MIDDLE=1,a.RIGHT=2}(a||(a={})),a}),define("nemesis.input/index",["require","exports","./keyboard","./mouse","./mouseButtons"],function(a,b,c,d,e){b.keyboard=c,b.mouse=d,b.mouseButtons=e}),define("math/glMatrix",["require","exports"],function(){var a;return function(a){function b(a){this.GLMAT_ARRAY_TYPE=a}function c(a){return a*d}a.GLMAT_EPSILON=1e-6,a.GLMAT_ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,a.GLMAT_RANDOM=Math.random;var d=Math.PI/180;a.setMarixArrayType=b,a.toRadian=c}(a||(a={})),a}),define("math/mat2",["require","exports","./glMatrix"],function(a,b,c){var d;return function(a){function b(){var a=new c.GLMAT_ARRAY_TYPE(4);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a}function d(a){var b=new c.GLMAT_ARRAY_TYPE(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b}function e(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a}function f(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a}function g(a,b){if(a===b){var c=b[1];a[1]=b[2],a[2]=c}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a}function h(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*f-e*d;return g?(g=1/g,a[0]=f*g,a[1]=-d*g,a[2]=-e*g,a[3]=c*g,a):null}function i(a,b){var c=b[0];return a[0]=b[3],a[1]=-b[1],a[2]=-b[2],a[3]=c,a}function j(a){return a[0]*a[3]-a[2]*a[1]}function k(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0],i=c[1],j=c[2],k=c[3];return a[0]=d*h+f*i,a[1]=e*h+g*i,a[2]=d*j+f*k,a[3]=e*j+g*k,a}function l(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+f*h,a[1]=e*i+g*h,a[2]=d*-h+f*i,a[3]=e*-h+g*i,a}function m(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0],i=c[1];return a[0]=d*h,a[1]=e*h,a[2]=f*i,a[3]=g*i,a}function n(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}function o(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))}function p(a,b,c,d){return a[2]=d[2]/d[0],c[0]=d[0],c[1]=d[1],c[3]=d[3]-a[2]*c[1],[a,b,c]}a.create=b,a.clone=d,a.copy=e,a.identity=f,a.transpose=g,a.invert=h,a.adjoint=i,a.determinant=j,a.multiply=k,a.mul=a.multiply,a.rotate=l,a.scale=m,a.str=n,a.frob=o,a.LDU=p}(d||(d={})),d}),define("math/mat2d",["require","exports","./glMatrix"],function(a,b,c){var d;return function(a){function b(){var a=new c.GLMAT_ARRAY_TYPE(6);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a}function d(a){var b=new c.GLMAT_ARRAY_TYPE(6);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b}function e(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a}function f(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a}function g(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=c*f-d*e;return i?(i=1/i,a[0]=f*i,a[1]=-d*i,a[2]=-e*i,a[3]=c*i,a[4]=(e*h-f*g)*i,a[5]=(d*g-c*h)*i,a):null}function h(a){return a[0]*a[3]-a[1]*a[2]}function i(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=c[0],k=c[1],l=c[2],m=c[3],n=c[4],o=c[5];return a[0]=d*j+f*k,a[1]=e*j+g*k,a[2]=d*l+f*m,a[3]=e*l+g*m,a[4]=d*n+f*o+h,a[5]=e*n+g*o+i,a}function j(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=Math.sin(c),k=Math.cos(c);return a[0]=d*k+f*j,a[1]=e*k+g*j,a[2]=d*-j+f*k,a[3]=e*-j+g*k,a[4]=h,a[5]=i,a}function k(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=c[0],k=c[1];return a[0]=d*j,a[1]=e*j,a[2]=f*k,a[3]=g*k,a[4]=h,a[5]=i,a}function l(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=c[0],k=c[1];return a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=d*j+f*k+h,a[5]=e*j+g*k+i,a}function m(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"}function n(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)}a.create=b,a.clone=d,a.copy=e,a.identity=f,a.invert=g,a.determinant=h,a.multiply=i,a.mul=a.multiply,a.rotate=j,a.scale=k,a.translate=l,a.str=m,a.frob=n}(d||(d={})),d}),define("math/mat3",["require","exports","./glMatrix"],function(a,b,c){var d;return function(a){function b(){var a=new c.GLMAT_ARRAY_TYPE(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}function d(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[4],a[4]=b[5],a[5]=b[6],a[6]=b[8],a[7]=b[9],a[8]=b[10],a}function e(a){var b=new c.GLMAT_ARRAY_TYPE(9);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b}function f(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a}function g(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a}function h(a,b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3],a[2]=b[6],a[3]=c,a[5]=b[7],a[6]=d,a[7]=e}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a}function i(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,o=c*l+d*m+e*n;return o?(o=1/o,a[0]=l*o,a[1]=(-k*d+e*j)*o,a[2]=(h*d-e*g)*o,a[3]=m*o,a[4]=(k*c-e*i)*o,a[5]=(-h*c+e*f)*o,a[6]=n*o,a[7]=(-j*c+d*i)*o,a[8]=(g*c-d*f)*o,a):null}function j(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8];return a[0]=g*k-h*j,a[1]=e*j-d*k,a[2]=d*h-e*g,a[3]=h*i-f*k,a[4]=c*k-e*i,a[5]=e*f-c*h,a[6]=f*j-g*i,a[7]=d*i-c*j,a[8]=c*g-d*f,a}function k(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*(j*f-g*i)+c*(-j*e+g*h)+d*(i*e-f*h)}function l(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7],u=c[8];return a[0]=m*d+n*g+o*j,a[1]=m*e+n*h+o*k,a[2]=m*f+n*i+o*l,a[3]=p*d+q*g+r*j,a[4]=p*e+q*h+r*k,a[5]=p*f+q*i+r*l,a[6]=s*d+t*g+u*j,a[7]=s*e+t*h+u*k,a[8]=s*f+t*i+u*l,a}function m(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1];return a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=m*d+n*g+j,a[7]=m*e+n*h+k,a[8]=m*f+n*i+l,a}function n(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=Math.sin(c),n=Math.cos(c);return a[0]=n*d+m*g,a[1]=n*e+m*h,a[2]=n*f+m*i,a[3]=n*g-m*d,a[4]=n*h-m*e,a[5]=n*i-m*f,a[6]=j,a[7]=k,a[8]=l,a}function o(a,b,c){var d=c[0],e=c[1];return a[0]=d*b[0],a[1]=d*b[1],a[2]=d*b[2],a[3]=e*b[3],a[4]=e*b[4],a[5]=e*b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a}function p(a,b){return a[0]=b[0],a[1]=b[1],a[2]=0,a[3]=b[2],a[4]=b[3],a[5]=0,a[6]=b[4],a[7]=b[5],a[8]=1,a}function q(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,i=e+e,j=c*g,k=d*g,l=d*h,m=e*g,n=e*h,o=e*i,p=f*g,q=f*h,r=f*i;return a[0]=1-l-o,a[3]=k-r,a[6]=m+q,a[1]=k+r,a[4]=1-j-o,a[7]=n-p,a[2]=m-q,a[5]=n+p,a[8]=1-j-l,a}function r(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(i*A-g*D-j*z)*E,a[2]=(g*C-h*A+j*y)*E,a[3]=(e*C-d*D-f*B)*E,a[4]=(c*D-e*A+f*z)*E,a[5]=(d*A-c*C-f*y)*E,a[6]=(p*x-q*w+r*v)*E,a[7]=(q*u-o*x-r*t)*E,a[8]=(o*w-p*u+r*s)*E,a):null}function s(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"}function t(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}a.create=b,a.fromMat4=d,a.clone=e,a.copy=f,a.identity=g,a.transpose=h,a.invert=i,a.adjoint=j,a.determinant=k,a.multiply=l,a.mul=a.multiply,a.translate=m,a.rotate=n,a.scale=o,a.fromMat2d=p,a.fromQuat=q,a.normalFromMat4=r,a.str=s,a.frob=t}(d||(d={})),d}),define("math/mat4",["require","exports","./glMatrix"],function(a,b,c){var d;return function(a){function b(){var a=new c.GLMAT_ARRAY_TYPE(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function d(a){var b=new c.GLMAT_ARRAY_TYPE(16);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b}function e(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a}function f(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function g(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=c,a[6]=b[9],a[7]=b[13],a[8]=d,a[9]=f,a[11]=b[14],a[12]=e,a[13]=g,a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a}function h(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(e*C-d*D-f*B)*E,a[2]=(p*x-q*w+r*v)*E,a[3]=(m*w-l*x-n*v)*E,a[4]=(i*A-g*D-j*z)*E,a[5]=(c*D-e*A+f*z)*E,a[6]=(q*u-o*x-r*t)*E,a[7]=(k*x-m*u+n*t)*E,a[8]=(g*C-h*A+j*y)*E,a[9]=(d*A-c*C-f*y)*E,a[10]=(o*w-p*u+r*s)*E,a[11]=(l*u-k*w-n*s)*E,a[12]=(h*z-g*B-i*y)*E,a[13]=(c*B-d*z+e*y)*E,a[14]=(p*t-o*v-q*s)*E,a[15]=(k*v-l*t+m*s)*E,a):null}function i(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15];return a[0]=h*(m*r-n*q)-l*(i*r-j*q)+p*(i*n-j*m),a[1]=-(d*(m*r-n*q)-l*(e*r-f*q)+p*(e*n-f*m)),a[2]=d*(i*r-j*q)-h*(e*r-f*q)+p*(e*j-f*i),a[3]=-(d*(i*n-j*m)-h*(e*n-f*m)+l*(e*j-f*i)),a[4]=-(g*(m*r-n*q)-k*(i*r-j*q)+o*(i*n-j*m)),a[5]=c*(m*r-n*q)-k*(e*r-f*q)+o*(e*n-f*m),a[6]=-(c*(i*r-j*q)-g*(e*r-f*q)+o*(e*j-f*i)),a[7]=c*(i*n-j*m)-g*(e*n-f*m)+k*(e*j-f*i),a[8]=g*(l*r-n*p)-k*(h*r-j*p)+o*(h*n-j*l),a[9]=-(c*(l*r-n*p)-k*(d*r-f*p)+o*(d*n-f*l)),a[10]=c*(h*r-j*p)-g*(d*r-f*p)+o*(d*j-f*h),a[11]=-(c*(h*n-j*l)-g*(d*n-f*l)+k*(d*j-f*h)),a[12]=-(g*(l*q-m*p)-k*(h*q-i*p)+o*(h*m-i*l)),a[13]=c*(l*q-m*p)-k*(d*q-e*p)+o*(d*m-e*l),a[14]=-(c*(h*q-i*p)-g*(d*q-e*p)+o*(d*i-e*h)),a[15]=c*(h*m-i*l)-g*(d*m-e*l)+k*(d*i-e*h),a}function j(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=b*g-c*f,s=b*h-d*f,t=b*i-e*f,u=c*h-d*g,v=c*i-e*g,w=d*i-e*h,x=j*o-k*n,y=j*p-l*n,z=j*q-m*n,A=k*p-l*o,B=k*q-m*o,C=l*q-m*p;return r*C-s*B+t*A+u*z-v*y+w*x}function k(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a}function l(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=c[0],q=c[1],r=c[2];return b===a?(a[12]=b[0]*p+b[4]*q+b[8]*r+b[12],a[13]=b[1]*p+b[5]*q+b[9]*r+b[13],a[14]=b[2]*p+b[6]*q+b[10]*r+b[14],a[15]=b[3]*p+b[7]*q+b[11]*r+b[15]):(d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=j,a[7]=k,a[8]=l,a[9]=m,a[10]=n,a[11]=o,a[12]=d*p+h*q+l*r+b[12],a[13]=e*p+i*q+m*r+b[13],a[14]=f*p+j*q+n*r+b[14],a[15]=g*p+k*q+o*r+b[15]),a}function m(a,b,c){var d=c[0],e=c[1],f=c[2];return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=b[7]*e,a[8]=b[8]*f,a[9]=b[9]*f,a[10]=b[10]*f,a[11]=b[11]*f,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a}function n(a,b,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=e[0],E=e[1],F=e[2],G=Math.sqrt(D*D+E*E+F*F);return Math.abs(G)<c.GLMAT_EPSILON?null:(G=1/G,D*=G,E*=G,F*=G,f=Math.sin(d),g=Math.cos(d),h=1-g,i=b[0],j=b[1],k=b[2],l=b[3],m=b[4],n=b[5],o=b[6],p=b[7],q=b[8],r=b[9],s=b[10],t=b[11],u=D*D*h+g,v=E*D*h+F*f,w=F*D*h-E*f,x=D*E*h-F*f,y=E*E*h+g,z=F*E*h+D*f,A=D*F*h+E*f,B=E*F*h-D*f,C=F*F*h+g,a[0]=i*u+m*v+q*w,a[1]=j*u+n*v+r*w,a[2]=k*u+o*v+s*w,a[3]=l*u+p*v+t*w,a[4]=i*x+m*y+q*z,a[5]=j*x+n*y+r*z,a[6]=k*x+o*y+s*z,a[7]=l*x+p*y+t*z,a[8]=i*A+m*B+q*C,a[9]=j*A+n*B+r*C,a[10]=k*A+o*B+s*C,a[11]=l*A+p*B+t*C,b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a)}function o(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*e+j*d,a[5]=g*e+k*d,a[6]=h*e+l*d,a[7]=i*e+m*d,a[8]=j*e-f*d,a[9]=k*e-g*d,a[10]=l*e-h*d,a[11]=m*e-i*d,a}function p(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e-j*d,a[1]=g*e-k*d,a[2]=h*e-l*d,a[3]=i*e-m*d,a[8]=f*d+j*e,a[9]=g*d+k*e,a[10]=h*d+l*e,a[11]=i*d+m*e,a}function q(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e+j*d,a[1]=g*e+k*d,a[2]=h*e+l*d,a[3]=i*e+m*d,a[4]=j*e-f*d,a[5]=k*e-g*d,a[6]=l*e-h*d,a[7]=m*e-i*d,a}function r(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=d+d,i=e+e,j=f+f,k=d*h,l=d*i,m=d*j,n=e*i,o=e*j,p=f*j,q=g*h,r=g*i,s=g*j;return a[0]=1-(n+p),a[1]=l+s,a[2]=m-r,a[3]=0,a[4]=l-s,a[5]=1-(k+p),a[6]=o+q,a[7]=0,a[8]=m+r,a[9]=o-q,a[10]=1-(k+n),a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a}function s(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,i=e+e,j=c*g,k=d*g,l=d*h,m=e*g,n=e*h,o=e*i,p=f*g,q=f*h,r=f*i;return a[0]=1-l-o,a[1]=k+r,a[2]=m-q,a[3]=0,a[4]=k-r,a[5]=1-j-o,a[6]=n+p,a[7]=0,a[8]=m+q,a[9]=n-p,a[10]=1-j-l,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function t(a,b,c,d,e,f,g){var h=1/(c-b),i=1/(e-d),j=1/(f-g);return a[0]=2*f*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*f*i,a[6]=0,a[7]=0,a[8]=(c+b)*h,a[9]=(e+d)*i,a[10]=(g+f)*j,a[11]=-1,a[12]=0,a[13]=0,a[14]=g*f*2*j,a[15]=0,a}function u(a,b,c,d,e){var f=1/Math.tan(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a}function v(a,b,c,d){var e=Math.tan(b.upDegrees*Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180),h=Math.tan(b.rightDegrees*Math.PI/180),i=2/(g+h),j=2/(e+f);return a[0]=i,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=j,a[6]=0,a[7]=0,a[8]=-((g-h)*i*.5),a[9]=(e-f)*j*.5,a[10]=d/(c-d),a[11]=-1,a[12]=0,a[13]=0,a[14]=d*c/(c-d),a[15]=0,a}function w(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a}function x(b,d,e,f){var g,h,i,j,k,l,m,n,o,p,q=d[0],r=d[1],s=d[2],t=f[0],u=f[1],v=f[2],w=e[0],x=e[1],y=e[2];return Math.abs(q-w)<c.GLMAT_EPSILON&&Math.abs(r-x)<c.GLMAT_EPSILON&&Math.abs(s-y)<c.GLMAT_EPSILON?a.identity(b):(m=q-w,n=r-x,o=s-y,p=1/Math.sqrt(m*m+n*n+o*o),m*=p,n*=p,o*=p,g=u*o-v*n,h=v*m-t*o,i=t*n-u*m,p=Math.sqrt(g*g+h*h+i*i),p?(p=1/p,g*=p,h*=p,i*=p):(g=0,h=0,i=0),j=n*i-o*h,k=o*g-m*i,l=m*h-n*g,p=Math.sqrt(j*j+k*k+l*l),p?(p=1/p,j*=p,k*=p,l*=p):(j=0,k=0,l=0),b[0]=g,b[1]=j,b[2]=m,b[3]=0,b[4]=h,b[5]=k,b[6]=n,b[7]=0,b[8]=i,b[9]=l,b[10]=o,b[11]=0,b[12]=-(g*q+h*r+i*s),b[13]=-(j*q+k*r+l*s),b[14]=-(m*q+n*r+o*s),b[15]=1,b)}function y(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}function z(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}a.create=b,a.clone=d,a.copy=e,a.identity=f,a.transpose=g,a.invert=h,a.adjoint=i,a.determinant=j,a.multiply=k,a.mul=a.multiply,a.translate=l,a.scale=m,a.rotate=n,a.rotateX=o,a.rotateY=p,a.rotateZ=q,a.fromRotationTranslation=r,a.fromQuat=s,a.frustum=t,a.perspective=u,a.perspectiveFromFieldOfView=v,a.ortho=w,a.lookAt=x,a.str=y,a.frob=z,a.IDENTITY=b()}(d||(d={})),d}),define("math/vec3",["require","exports","./glMatrix"],function(a,b,c){var d;return function(a){function b(){var a=new c.GLMAT_ARRAY_TYPE(3);return a[0]=0,a[1]=0,a[2]=0,a}function d(a){var b=new c.GLMAT_ARRAY_TYPE(3);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b}function e(a,b,d){var e=new c.GLMAT_ARRAY_TYPE(3);return e[0]=a,e[1]=b,e[2]=d,e}function f(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a}function g(a,b,c,d){return a[0]=b,a[1]=c,a[2]=d,a}function h(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a}function i(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a}function j(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a}function k(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a}function l(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a}function m(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a}function n(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a}function o(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a}function p(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)}function q(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e}function r(a){var b=a[0],c=a[1],d=a[2];return Math.sqrt(b*b+c*c+d*d)}function s(a){var b=a[0],c=a[1],d=a[2];return b*b+c*c+d*d}function t(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a}function u(a,b){return a[0]=1/b[0],a[1]=1/b[1],a[2]=1/b[2],a}function v(a,b){var c=b[0],d=b[1],e=b[2],f=c*c+d*d+e*e;return f>0&&(f=1/Math.sqrt(f),a[0]=b[0]*f,a[1]=b[1]*f,a[2]=b[2]*f),a}function w(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function x(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2];return a[0]=e*i-f*h,a[1]=f*g-d*i,a[2]=d*h-e*g,a}function y(a,b,c,d){var e=b[0],f=b[1],g=b[2];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a}function z(a,b){b=b||1;var d=2*c.GLMAT_RANDOM()*Math.PI,e=2*c.GLMAT_RANDOM()-1,f=Math.sqrt(1-e*e)*b;return a[0]=Math.cos(d)*f,a[1]=Math.sin(d)*f,a[2]=e*b,a}function A(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[3]*d+c[7]*e+c[11]*f+c[15];return g=g||1,a[0]=(c[0]*d+c[4]*e+c[8]*f+c[12])/g,a[1]=(c[1]*d+c[5]*e+c[9]*f+c[13])/g,a[2]=(c[2]*d+c[6]*e+c[10]*f+c[14])/g,a}function B(a,b,c){var d=b[0],e=b[1],f=b[2];return a[0]=d*c[0]+e*c[3]+f*c[6],a[1]=d*c[1]+e*c[4]+f*c[7],a[2]=d*c[2]+e*c[5]+f*c[8],a}function C(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2],j=c[3],k=j*d+h*f-i*e,l=j*e+i*d-g*f,m=j*f+g*e-h*d,n=-g*d-h*e-i*f;return a[0]=k*j+n*-g+l*-i-m*-h,a[1]=l*j+n*-h+m*-g-k*-i,a[2]=m*j+n*-i+k*-h-l*-g,a}function D(a,b,c,d){var e=[],f=[];return e[0]=b[0]-c[0],e[1]=b[1]-c[1],e[2]=b[2]-c[2],f[0]=e[0],f[1]=e[1]*Math.cos(d)-e[2]*Math.sin(d),f[2]=e[1]*Math.sin(d)+e[2]*Math.cos(d),a[0]=f[0]+c[0],a[1]=f[1]+c[1],a[2]=f[2]+c[2],a}function E(a,b,c,d){var e=[],f=[];return e[0]=b[0]-c[0],e[1]=b[1]-c[1],e[2]=b[2]-c[2],f[0]=e[2]*Math.sin(d)+e[0]*Math.cos(d),f[1]=e[1],f[2]=e[2]*Math.cos(d)-e[0]*Math.sin(d),a[0]=f[0]+c[0],a[1]=f[1]+c[1],a[2]=f[2]+c[2],a}function F(a,b,c,d){var e=[],f=[];return e[0]=b[0]-c[0],e[1]=b[1]-c[1],e[2]=b[2]-c[2],f[0]=e[0]*Math.cos(d)-e[1]*Math.sin(d),f[1]=e[0]*Math.sin(d)+e[1]*Math.cos(d),f[2]=e[2],a[0]=f[0]+c[0],a[1]=f[1]+c[1],a[2]=f[2]+c[2],a}function G(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}a.create=b,a.clone=d,a.fromValues=e,a.copy=f,a.set=g,a.add=h,a.subtract=i,a.multiply=j,a.divide=k,a.min=l,a.max=m,a.scale=n,a.scaleAndAdd=o,a.distance=p,a.squaredDistance=q,a.length=r,a.len=a.length,a.squaredLength=s,a.sqrLen=a.squaredLength,a.negate=t,a.inverse=u,a.normalize=v,a.dot=w,a.cross=x,a.lerp=y,a.random=z,a.transformMat4=A,a.transformMat3=B,a.transformQuat=C,a.rotateX=D,a.rotateY=E,a.rotateZ=F,a.forEach=function(){var b=a.create();return function(a,c,d,e,f,g){var h,i;for(c||(c=3),d||(d=0),i=e?Math.min(e*c+d,a.length):a.length,h=d;i>h;h+=c)b[0]=a[h],b[1]=a[h+1],b[2]=a[h+2],f(b,b,g),a[h]=b[0],a[h+1]=b[1],a[h+2]=b[2];return a}}(),a.str=G,a.UNIT_X=a.fromValues(1,0,0),a.UNIT_Y=a.fromValues(0,1,0),a.UNIT_Z=a.fromValues(0,0,1)}(d||(d={})),d}),define("math/vec4",["require","exports","./glMatrix"],function(a,b,c){var d;return function(a){function b(){var a=new c.GLMAT_ARRAY_TYPE(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a}function d(a){var b=new c.GLMAT_ARRAY_TYPE(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b}function e(a,b,d,e){var f=new c.GLMAT_ARRAY_TYPE(4);return f[0]=a,f[1]=b,f[2]=d,f[3]=e,f}function f(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a}function g(a,b,c,d,e){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a}function h(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a[3]=b[3]+c[3],a}function i(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a[3]=b[3]-c[3],a}function j(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a[3]=b[3]*c[3],a}function k(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a[3]=b[3]/c[3],a}function l(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a[3]=Math.min(b[3],c[3]),a}function m(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a[3]=Math.max(b[3],c[3]),a}function n(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a}function o(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a[3]=b[3]+c[3]*d,a}function p(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return Math.sqrt(c*c+d*d+e*e+f*f)}function q(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f}function r(a){var b=a[0],c=a[1],d=a[2],e=a[3];return Math.sqrt(b*b+c*c+d*d+e*e)}function s(a){var b=a[0],c=a[1],d=a[2],e=a[3];return b*b+c*c+d*d+e*e}function t(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=-b[3],a}function u(a,b){return a[0]=1/b[0],a[1]=1/b[1],a[2]=1/b[2],a[3]=1/b[3],a}function v(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*c+d*d+e*e+f*f;return g>0&&(g=1/Math.sqrt(g),a[0]=b[0]*g,a[1]=b[1]*g,a[2]=b[2]*g,a[3]=b[3]*g),a}function w(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function x(a,b,c,d){var e=b[0],f=b[1],g=b[2],h=b[3];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a[3]=h+d*(c[3]-h),a}function y(b,d){return d=d||1,b[0]=c.GLMAT_RANDOM(),b[1]=c.GLMAT_RANDOM(),b[2]=c.GLMAT_RANDOM(),b[3]=c.GLMAT_RANDOM(),a.normalize(b,b),a.scale(b,b,d),b}function z(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3];return a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*g,a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*g,a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*g,a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*g,a}function A(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2],j=c[3],k=j*d+h*f-i*e,l=j*e+i*d-g*f,m=j*f+g*e-h*d,n=-g*d-h*e-i*f;return a[0]=k*j+n*-g+l*-i-m*-h,a[1]=l*j+n*-h+m*-g-k*-i,a[2]=m*j+n*-i+k*-h-l*-g,a[3]=b[3],a}function B(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}a.create=b,a.clone=d,a.fromValues=e,a.copy=f,a.set=g,a.add=h,a.subtract=i,a.sub=a.subtract,a.multiply=j,a.mul=a.multiply,a.divide=k,a.div=a.divide,a.min=l,a.max=m,a.scale=n,a.scaleAndAdd=o,a.distance=p,a.dist=a.distance,a.squaredDistance=q,a.sqrDist=a.squaredDistance,a.length=r,a.len=a.length,a.squaredLength=s,a.sqrLen=a.squaredLength,a.negate=t,a.inverse=u,a.normalize=v,a.dot=w,a.lerp=x,a.random=y,a.transformMat4=z,a.transformQuat=A,a.forEach=function(){var b=a.create();return function(a,c,d,e,f,g){var h,i;for(c||(c=4),d||(d=0),i=e?Math.min(e*c+d,a.length):a.length,h=d;i>h;h+=c)b[0]=a[h],b[1]=a[h+1],b[2]=a[h+2],b[3]=a[h+3],f(b,b,g),a[h]=b[0],a[h+1]=b[1],a[h+2]=b[2],a[h+3]=b[3];return a}}(),a.str=B}(d||(d={})),d}),define("math/quat",["require","exports","./glMatrix","./vec3","./mat3","./vec4"],function(a,b,c,d,e,f){var g;return function(a){function b(){var a=new c.GLMAT_ARRAY_TYPE(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function g(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function h(a,b,c){c=.5*c;var d=Math.sin(c);return a[0]=d*b[0],a[1]=d*b[1],a[2]=d*b[2],a[3]=Math.cos(c),a}function i(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0],i=c[1],j=c[2],k=c[3];return a[0]=d*k+g*h+e*j-f*i,a[1]=e*k+g*i+f*h-d*j,a[2]=f*k+g*j+d*i-e*h,a[3]=g*k-d*h-e*i-f*j,a}function j(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+g*h,a[1]=e*i+f*h,a[2]=f*i-e*h,a[3]=g*i-d*h,a}function k(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i-f*h,a[1]=e*i+g*h,a[2]=f*i+d*h,a[3]=g*i-e*h,a}function l(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+e*h,a[1]=e*i-d*h,a[2]=f*i+g*h,a[3]=g*i-f*h,a}function m(a,b){var c=b[0],d=b[1],e=b[2];return a[0]=c,a[1]=d,a[2]=e,a[3]=Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a}function n(a,b,c,d){var e,f,g,h,i,j=b[0],k=b[1],l=b[2],m=b[3],n=c[0],o=c[1],p=c[2],q=c[3];return f=j*n+k*o+l*p+m*q,0>f&&(f=-f,n=-n,o=-o,p=-p,q=-q),1-f>1e-6?(e=Math.acos(f),g=Math.sin(e),h=Math.sin((1-d)*e)/g,i=Math.sin(d*e)/g):(h=1-d,i=d),a[0]=h*j+i*n,a[1]=h*k+i*o,a[2]=h*l+i*p,a[3]=h*m+i*q,a}function o(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*c+d*d+e*e+f*f,h=g?1/g:0;return a[0]=-c*h,a[1]=-d*h,a[2]=-e*h,a[3]=f*h,a}function p(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=b[3],a}function q(a,b){var c,d=b[0]+b[4]+b[8];if(d>0)c=Math.sqrt(d+1),a[3]=.5*c,c=.5/c,a[0]=(b[5]-b[7])*c,a[1]=(b[6]-b[2])*c,a[2]=(b[1]-b[3])*c;else{var e=0;b[4]>b[0]&&(e=1),b[8]>b[3*e+e]&&(e=2);var f=(e+1)%3,g=(e+2)%3;c=Math.sqrt(b[3*e+e]-b[3*f+f]-b[3*g+g]+1),a[e]=.5*c,c=.5/c,a[3]=(b[3*f+g]-b[3*g+f])*c,a[f]=(b[3*f+e]+b[3*e+f])*c,a[g]=(b[3*g+e]+b[3*e+g])*c}return a}function r(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}a.create=b,a.rotationTo=function(){var b=d.create(),c=d.fromValues(1,0,0),e=d.fromValues(0,1,0);return function(f,g,h){var i=d.dot(g,h);return-.999999>i?(d.cross(b,c,g),d.length(b)<1e-6&&d.cross(b,e,g),d.normalize(b,b),a.setAxisAngle(f,b,Math.PI),f):i>.999999?(f[0]=0,f[1]=0,f[2]=0,f[3]=1,f):(d.cross(b,g,h),f[0]=b[0],f[1]=b[1],f[2]=b[2],f[3]=1+i,a.normalize(f,f))}}(),a.setAxes=function(){var b=e.create();return function(c,d,e,f){return b[0]=e[0],b[3]=e[1],b[6]=e[2],b[1]=f[0],b[4]=f[1],b[7]=f[2],b[2]=-d[0],b[5]=-d[1],b[8]=-d[2],a.normalize(c,a.fromMat3(c,b))}}(),a.clone=f.clone,a.fromValues=f.fromValues,a.copy=f.copy,a.set=f.set,a.identity=g,a.setAxisAngle=h,a.add=f.add,a.multiply=i,a.mul=a.multiply,a.scale=f.scale,a.rotateX=j,a.rotateY=k,a.rotateZ=l,a.calculateW=m,a.dot=f.dot,a.lerp=f.lerp,a.slerp=n,a.invert=o,a.conjugate=p,a.length=f.length,a.len=a.length,a.squaredLength=f.squaredLength,a.sqrLen=a.squaredLength,a.normalize=f.normalize,a.fromMat3=q,a.str=r}(g||(g={})),g}),define("math/vec2",["require","exports","./glMatrix"],function(a,b,c){var d;return function(a){function b(){var a=new c.GLMAT_ARRAY_TYPE(2);return a[0]=0,a[1]=0,a}function d(a){var b=new c.GLMAT_ARRAY_TYPE(2);return b[0]=a[0],b[1]=a[1],b}function e(a,b){var d=new c.GLMAT_ARRAY_TYPE(2);return d[0]=a,d[1]=b,d}function f(a,b){return a[0]=b[0],a[1]=b[1],a}function g(a,b,c){return a[0]=b,a[1]=c,a}function h(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a}function i(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a}function j(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a}function k(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a}function l(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a}function m(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a}function n(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a}function o(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a}function p(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)}function q(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d}function r(a){var b=a[0],c=a[1];return Math.sqrt(b*b+c*c)}function s(a){var b=a[0],c=a[1];return b*b+c*c}function t(a,b){return a[0]=-b[0],a[1]=-b[1],a}function u(a,b){return a[0]=1/b[0],a[1]=1/b[1],a}function v(a,b){var c=b[0],d=b[1],e=c*c+d*d;return e>0&&(e=1/Math.sqrt(e),a[0]=b[0]*e,a[1]=b[1]*e),a}function w(a,b){return a[0]*b[0]+a[1]*b[1]}function x(a,b,c){var d=b[0]*c[1]-b[1]*c[0];return a[0]=a[1]=0,a[2]=d,a}function y(a,b,c,d){var e=b[0],f=b[1];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a}function z(a,b){b=b||1;var d=2*c.GLMAT_RANDOM()*Math.PI;return a[0]=Math.cos(d)*b,a[1]=Math.sin(d)*b,a}function A(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[2]*e,a[1]=c[1]*d+c[3]*e,a}function B(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[2]*e+c[4],a[1]=c[1]*d+c[3]*e+c[5],a}function C(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[3]*e+c[6],a[1]=c[1]*d+c[4]*e+c[7],a}function D(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[4]*e+c[12],a[1]=c[1]*d+c[5]*e+c[13],a}function E(a){return"vec2("+a[0]+", "+a[1]+")"}a.create=b,a.clone=d,a.fromValues=e,a.copy=f,a.set=g,a.add=h,a.subtract=i,a.multiply=j,a.divide=k,a.min=l,a.max=m,a.scale=n,a.scaleAndAdd=o,a.distance=p,a.squaredDistance=q,a.length=r,a.squaredLength=s,a.negate=t,a.inverse=u,a.normalize=v,a.dot=w,a.cross=x,a.lerp=y,a.random=z,a.transformMat2=A,a.transformMat2d=B,a.transformMat3=C,a.transformMat4=D,a.forEach=function(){var b=a.create();return function(a,c,d,e,f,g){var h,i;for(c||(c=2),d||(d=0),i=e?Math.min(e*c+d,a.length):a.length,h=d;i>h;h+=c)b[0]=a[h],b[1]=a[h+1],f(b,b,g),a[h]=b[0],a[h+1]=b[1];return a}}(),a.str=E}(d||(d={})),d}),define("math/index",["require","exports","./mat2","./mat2d","./mat3","./mat4","./quat","./vec2","./vec3","./vec4"],function(a,b,c,d,e,f,g,h,i,j){b.mat2=c,b.mat2d=d,b.mat3=e,b.mat4=f,b.quat=g,b.vec2=h,b.vec3=i,b.vec4=j}),define("config",["require","exports","./canvas"],function(a,b,c){var d={};return"true"==c.getAttribute("debug")&&(d.throwOnGLError=!0,d.logGLCalls=!0,d.validateGLArgs=!0),d
}),define("nemesis.util/debug/webgl",["require","exports","../logger/consoleLogger"],function(a,b,c){var d;return function(a){function b(a){if(null==n){n={},o={};for(var b in a)"number"==typeof a[b]&&(n[a[b]]=b,o[b]=a[b])}}function d(){if(null==n)throw"WebGLDebugUtils.init(ctx) not called"}function e(a){return d(),void 0!==n[a]}function f(a){d();var b=n[a];return void 0!==b?"gl."+b:"/*UNKNOWN WebGL ENUM*/ 0x"+a.toString(16)}function g(a,b,c,d){var e=m[a];if(void 0!==e){var e=e[b];if(void 0!==e&&e[c]){if("object"==typeof e[c]&&void 0!==e[c].enumBitwiseOr){for(var g=e[c].enumBitwiseOr,h=0,i=[],j=0;j<g.length;++j){var k=o[g[j]];0!==(d&k)&&(h|=k,i.push(f(k)))}return h===d?i.join(" | "):f(d)}return f(d)}}return null===d?"null":void 0===d?"undefined":d.toString()}function h(a,b){for(var c="",d=b.length,e=0;d>e;++e)c+=(0==e?"":", ")+g(a,d,e,b[e]);return c}function i(a,b,c){a.__defineGetter__(c,function(){return b[c]}),a.__defineSetter__(c,function(a){b[c]=a})}function j(a,d,e,h){function k(a,b){return function(){e&&e(b,arguments);var c=a[b].apply(a,arguments),f=h.getError();return 0!=f&&(l[f]=!0,d(f,b,arguments)),c}}h=h||a,b(a),d=d||function(a,b,d){for(var e="",h=d.length,i=0;h>i;++i)e+=(0==i?"":", ")+g(b,h,i,d[i]);c.logError("WebGL error "+f(a)+" in "+b+"("+e+")")};var l={},m={};for(var n in a)if("function"==typeof a[n])if("getExtension"!=n)m[n]=k(a,n);else{var o=k(a,n);m[n]=function(){var b=o.apply(a,arguments);return j(b,d,e,h)}}else i(m,a,n);return m.getError=function(){for(var b in l)if(l.hasOwnProperty(b)&&l[b])return l[b]=!1,b;return a.NO_ERROR},m}function k(a){var b=a.getParameter(a.MAX_VERTEX_ATTRIBS),c=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,c);for(var d=0;b>d;++d)a.disableVertexAttribArray(d),a.vertexAttribPointer(d,4,a.FLOAT,!1,0,0),a.vertexAttrib1f(d,0);a.deleteBuffer(c);for(var e=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),d=0;e>d;++d)a.activeTexture(a.TEXTURE0+d),a.bindTexture(a.TEXTURE_CUBE_MAP,null),a.bindTexture(a.TEXTURE_2D,null);for(a.activeTexture(a.TEXTURE0),a.useProgram(null),a.bindBuffer(a.ARRAY_BUFFER,null),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null),a.bindFramebuffer(a.FRAMEBUFFER,null),a.bindRenderbuffer(a.RENDERBUFFER,null),a.disable(a.BLEND),a.disable(a.CULL_FACE),a.disable(a.DEPTH_TEST),a.disable(a.DITHER),a.disable(a.SCISSOR_TEST),a.blendColor(0,0,0,0),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ONE,a.ZERO),a.clearColor(0,0,0,0),a.clearDepth(1),a.clearStencil(-1),a.colorMask(!0,!0,!0,!0),a.cullFace(a.BACK),a.depthFunc(a.LESS),a.depthMask(!0),a.depthRange(0,1),a.frontFace(a.CCW),a.hint(a.GENERATE_MIPMAP_HINT,a.DONT_CARE),a.lineWidth(1),a.pixelStorei(a.PACK_ALIGNMENT,4),a.pixelStorei(a.UNPACK_ALIGNMENT,4),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!1),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.UNPACK_COLORSPACE_CONVERSION_WEBGL&&a.pixelStorei(a.UNPACK_COLORSPACE_CONVERSION_WEBGL,a.BROWSER_DEFAULT_WEBGL),a.polygonOffset(0,0),a.sampleCoverage(1,!1),a.scissor(0,0,a.canvas.width,a.canvas.height),a.stencilFunc(a.ALWAYS,0,4294967295),a.stencilMask(4294967295),a.stencilOp(a.KEEP,a.KEEP,a.KEEP),a.viewport(0,0,a.canvas.width,a.canvas.height),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT|a.STENCIL_BUFFER_BIT);a.getError(););}function l(a){function b(a){return"function"==typeof a?a:function(b){a.handleEvent(b)}}function c(a){var b=a.addEventListener;a.addEventListener=function(c,d){switch(c){case"webglcontextlost":x(d);break;case"webglcontextrestored":y(d);break;default:b.apply(a,arguments)}}}function d(){for(var a=Object.keys(w),b=0;b<a.length;++b)delete w[a]}function e(){++t,q||s==t&&a.loseContext()}function f(a,b){var c=a[b];return function(){if(e(),!q){var b=c.apply(a,arguments);return b}}}function g(){for(var a=0;a<r.length;++a){var b=r[a];b instanceof WebGLBuffer?l.deleteBuffer(b):b instanceof WebGLFramebuffer?l.deleteFramebuffer(b):b instanceof WebGLProgram?l.deleteProgram(b):b instanceof WebGLRenderbuffer?l.deleteRenderbuffer(b):b instanceof WebGLShader?l.deleteShader(b):b instanceof WebGLTexture&&l.deleteTexture(b)}}function h(a){return{statusMessage:a,preventDefault:function(){u=!0}}}function j(a){for(var b in a)"function"==typeof a[b]?m[b]=f(a,b):i(m,a,b);m.getError=function(){if(e(),!q)for(var a;a=l.getError();)w[a]=!0;for(var a in w)if(w[a])return delete w[a],a;return m.NO_ERROR};for(var c=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],d=0;d<c.length;++d){var g=c[d];m[g]=function(b){return function(){if(e(),q)return null;var c=b.apply(a,arguments);return c.__webglDebugContextLostId__=p,r.push(c),c}}(a[g])}for(var h=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"],d=0;d<h.length;++d){var g=h[d];m[g]=function(b){return function(){return e(),q?null:b.apply(a,arguments)}}(m[g])}for(var j=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"],d=0;d<j.length;++d){var g=j[d];m[g]=function(b){return function(){return e(),q?!1:b.apply(a,arguments)}}(m[g])}return m.checkFramebufferStatus=function(b){return function(){return e(),q?m.FRAMEBUFFER_UNSUPPORTED:b.apply(a,arguments)}}(m.checkFramebufferStatus),m.getAttribLocation=function(b){return function(){return e(),q?-1:b.apply(a,arguments)}}(m.getAttribLocation),m.getVertexAttribOffset=function(b){return function(){return e(),q?0:b.apply(a,arguments)}}(m.getVertexAttribOffset),m.isContextLost=function(){return q},m}var l,m={},n=[],o=[],p=1,q=!1,r=[],s=0,t=0,u=!1,v=0,w={};a.getContext=function(b){return function(){var c=b.apply(a,arguments);if(c instanceof WebGLRenderingContext){if(c!=l){if(l)throw"got different context";l=c,m=j(l)}return m}return c}}(a.getContext);var x=function(a){n.push(b(a))},y=function(a){o.push(b(a))};return c(a),a.loseContext=function(){if(!q){for(q=!0,s=0,++p;l.getError(););d(),w[l.CONTEXT_LOST_WEBGL]=!0;var b=h("context lost"),c=n.slice();setTimeout(function(){for(var d=0;d<c.length;++d)c[d](b);v>=0&&setTimeout(function(){a.restoreContext()},v)},0)}},a.restoreContext=function(){q&&o.length&&setTimeout(function(){if(!u)throw"can not restore. webglcontestlost listener did not call event.preventDefault";g(),k(l),q=!1,t=0,u=!1;for(var a=o.slice(),b=h("context restored"),c=0;c<a.length;++c)a[c](b)},0)},a.loseContextInNCalls=function(a){if(q)throw"You can not ask a lost contet to be lost";s=t+a},a.getNumCalls=function(){return t},a.setRestoreTimeout=function(a){v=a},a}var m={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},n=null,o=null;a.init=b,a.mightBeEnum=e,a.glEnumToString=f,a.glFunctionArgToString=g,a.glFunctionArgsToString=h,a.makeDebugContext=j,a.resetToInitialState=k,a.makeLostContextSimulatingCanvas=l}(d||(d={})),d}),define("nemesis.render3D/glContext",["require","exports","../canvas","../config","../nemesis.util/logger/consoleLogger","../nemesis.util/debug/webgl"],function(a,b,c,d,e,f){function g(a,b){if(d.throwOnGLError)throw f.glEnumToString(a)+" was caused by call to: "+b}function h(a,b){e.log("gl."+a+"("+f.glFunctionArgsToString(a,b)+")")}function i(a,b){for(var c=0;c<b.length;++c)void 0===b[c]&&e.logError("undefined passed to gl."+a+"("+f.glFunctionArgsToString(a,b)+")")}function j(a,b){d.logGLCalls&&h(a,b),d.validateGLArgs&&i(a,b)}var k;try{k=c.getContext("experimental-webgl",{antialias:!0}),k=f.makeDebugContext(k,g,j)}catch(l){e.logError("Error getting webgl context.",l)}return k}),define("text",["module"],function(a){var b,c,d,e,f,g=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],h=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,i=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,j="undefined"!=typeof location&&location.href,k=j&&location.protocol&&location.protocol.replace(/\:/,""),l=j&&location.hostname,m=j&&(location.port||void 0),n={},o=a.config&&a.config()||{};return b={version:"2.0.12",strip:function(a){if(a){a=a.replace(h,"");var b=a.match(i);b&&(a=b[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:o.createXhr||function(){var a,b,c;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(b=0;3>b;b+=1){c=g[b];try{a=new ActiveXObject(c)}catch(d){}if(a){g=[c];break}}return a},parseName:function(a){var b,c,d,e=!1,f=a.indexOf("."),g=0===a.indexOf("./")||0===a.indexOf("../");return-1!==f&&(!g||f>1)?(b=a.substring(0,f),c=a.substring(f+1,a.length)):b=a,d=c||b,f=d.indexOf("!"),-1!==f&&(e="strip"===d.substring(f+1),d=d.substring(0,f),c?c=d:b=d),{moduleName:b,ext:c,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,e){var f,g,h,i=b.xdRegExp.exec(a);return i?(f=i[2],g=i[3],g=g.split(":"),h=g[1],g=g[0],!(f&&f!==c||g&&g.toLowerCase()!==d.toLowerCase()||(h||g)&&h!==e)):!0},finishLoad:function(a,c,d,e){d=c?b.strip(d):d,o.isBuild&&(n[a]=d),e(d)},load:function(a,c,d,e){if(e&&e.isBuild&&!e.inlineText)return void d();o.isBuild=e&&e.isBuild;var f=b.parseName(a),g=f.moduleName+(f.ext?"."+f.ext:""),h=c.toUrl(g),i=o.useXhr||b.useXhr;return 0===h.indexOf("empty:")?void d():void(!j||i(h,k,l,m)?b.get(h,function(c){b.finishLoad(a,f.strip,c,d)},function(a){d.error&&d.error(a)}):c([g],function(a){b.finishLoad(f.moduleName+"."+f.ext,f.strip,a,d)}))},write:function(a,c,d){if(n.hasOwnProperty(c)){var e=b.jsEscape(n[c]);d.asModule(a+"!"+c,"define(function () { return '"+e+"';});\n")}},writeFile:function(a,c,d,e,f){var g=b.parseName(c),h=g.ext?"."+g.ext:"",i=g.moduleName+h,j=d.toUrl(g.moduleName+h)+".js";b.load(i,d,function(){var c=function(a){return e(j,a)};c.asModule=function(a,b){return e.asModule(a,j,b)},b.write(a,i,c,f)},f)}},"node"===o.env||!o.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(c=require.nodeRequire("fs"),b.get=function(a,b,d){try{var e=c.readFileSync(a,"utf8");0===e.indexOf("﻿")&&(e=e.substring(1)),b(e)}catch(f){d&&d(f)}}):"xhr"===o.env||!o.env&&b.createXhr()?b.get=function(a,c,d,e){var f,g=b.createXhr();if(g.open("GET",a,!0),e)for(f in e)e.hasOwnProperty(f)&&g.setRequestHeader(f.toLowerCase(),e[f]);o.onXhr&&o.onXhr(g,a),g.onreadystatechange=function(){var b,e;4===g.readyState&&(b=g.status||0,b>399&&600>b?(e=new Error(a+" HTTP status: "+b),e.xhr=g,d&&d(e)):c(g.responseText),o.onXhrComplete&&o.onXhrComplete(g,a))},g.send(null)}:"rhino"===o.env||!o.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?b.get=function(a,b){var c,d,e="utf-8",f=new java.io.File(a),g=java.lang.System.getProperty("line.separator"),h=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f),e)),i="";try{for(c=new java.lang.StringBuffer,d=h.readLine(),d&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1)),null!==d&&c.append(d);null!==(d=h.readLine());)c.append(g),c.append(d);i=String(c.toString())}finally{h.close()}b(i)}:("xpconnect"===o.env||!o.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(d=Components.classes,e=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),f="@mozilla.org/windows-registry-key;1"in d,b.get=function(a,b){var c,g,h,i={};f&&(a=a.replace(/\//g,"\\")),h=new FileUtils.File(a);try{c=d["@mozilla.org/network/file-nemesis.input-stream;1"].createInstance(e.nsIFileInputStream),c.init(h,1,0,!1),g=d["@mozilla.org/intl/converter-nemesis.input-stream;1"].createInstance(e.nsIConverterInputStream),g.init(c,"utf-8",c.available(),e.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),g.readString(c.available(),i),g.close(),c.close(),b(i.value)}catch(j){throw new Error((h&&h.path||"")+": "+j)}}),b}),define("text!nemesis.shaders/common.glsl",[],function(){return"vec4 getPosition(mat4 mvp, vec3 pos) {\r\n    return mvp * vec4(pos, 1);\r\n}"}),define("text!nemesis.shaders/base_vertex.glsl",[],function(){return"#include common.glsl\r\n\r\nattribute vec3 aVertex;\r\nuniform mat4 mvp;\r\n\r\nvoid main(void) {\r\n    gl_Position = mvp * vec4(aVertex, 1.);\r\n}"}),define("text!nemesis.shaders/color_frag.glsl",[],function(){return"precision mediump float;\r\nuniform vec3 vColor;\r\nvoid main(void) {\r\n    gl_FragColor = vec4(vColor, 1.);\r\n}"}),define("text!nemesis.shaders/tex_frag.glsl",[],function(){return"precision mediump float;\r\n\r\nuniform sampler2D sampler;\r\nvarying vec2 vUV;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = texture2D(sampler, vUV);\r\n}"}),define("text!nemesis.shaders/tex_vertex.glsl",[],function(){return"attribute vec3 aVertex;\r\nuniform mat4 mvp;\r\n\r\nattribute vec2 aUV;\r\nvarying vec2 vUV;\r\n\r\nvoid main(void) {\r\n    gl_Position = mvp * vec4(aVertex, 1.);\r\n    vUV = aUV;\r\n}"}),define("nemesis.render3D/nemesis.shaders",["require","exports","./glContext","../nemesis.util/logger/consoleLogger","text!../nemesis.shaders/common.glsl","text!../nemesis.shaders/base_vertex.glsl","text!../nemesis.shaders/color_frag.glsl","text!../nemesis.shaders/tex_frag.glsl","text!../nemesis.shaders/tex_vertex.glsl"],function(a,b,c,d,e,f,g,h,i){var j;return function(a){function b(a){return a=a.replace(m,function(a){var b=a.replace("#include","").trim();return n[b]?n[b]:(d.logError("Shader lib ["+b+"] not found."),"")})}function j(a,c){c=b(c),n[a]=c}function k(a,e){a=b(a);var f=c.createShader(e);return c.shaderSource(f,a),c.compileShader(f),c.getShaderParameter(f,c.COMPILE_STATUS)?f:(d.logError("Error compiling shader:"+c.getShaderInfoLog(f)),null)}function l(a,b){var d=c.createProgram();return c.attachShader(d,a),c.attachShader(d,b),c.linkProgram(d),d}var m=/#include \S+/,n={};a.compileLib=j,a.compile=k,a.createProgram=l,j("common.glsl",e),a.baseVertexShader=k(f,c.VERTEX_SHADER),a.colorFragmentShader=k(g,c.FRAGMENT_SHADER),a.textureVertexShader=k(i,c.VERTEX_SHADER),a.textureFragmentShader=k(h,c.FRAGMENT_SHADER)}(j||(j={})),j}),define("nemesis.render3D/render",["require","exports","./glContext"],function(a,b,c){var d;return function(a){function b(){c.clearColor(0,0,0,0),c.enable(c.DEPTH_TEST),c.depthFunc(c.LEQUAL),c.clearDepth(1)}function d(){c.viewport(0,0,c.canvas.width,c.canvas.height),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT)}function e(){c.flush()}a.init=b,a.begin=d,a.end=e}(d||(d={})),d}),define("nemesis.render3D/camera",["require","exports","../canvas","../math/vec3","../math/mat4"],function(a,b,c,d,e){var f=function(){function a(a,b){this._pos=a||d.create(),this._target=b||d.create(),this._fov=45,this._aspect=c.width/c.height,this._nearClip=1,this._farClip=100,this._proj=e.perspective(e.create(),this._fov,this._aspect,this._nearClip,this._farClip)}return a.prototype.fov=function(a){return a&&(this._fov=a,e.perspective(this._proj,this._fov,this._aspect,this._nearClip,this._farClip)),this._fov},a.prototype.nearClip=function(a){return a&&(this._nearClip=a,e.perspective(this._proj,this._fov,this._aspect,this._nearClip,this._farClip)),this._nearClip},a.prototype.farClip=function(a){return a&&(this._farClip=a,e.perspective(this._proj,this._fov,this._aspect,this._nearClip,this._farClip)),this._farClip},a.prototype.aspectRatio=function(a){return a&&(this._aspect=a,e.perspective(this._proj,this._fov,this._aspect,this._nearClip,this._farClip)),this._aspect},a.prototype.projectionView=function(){var a=e.create();return e.lookAt(a,this._pos,this._target,d.UNIT_Y),e.mul(a,this._proj,a)},a.prototype.getProjection=function(){return e.copy(e.create(),this._proj)},a.prototype.getView=function(){return e.lookAt(e.create(),this._pos,this._target,d.UNIT_Y)},a}();return f}),define("nemesis.util/logger/index",["require","exports","./consoleLogger"],function(a,b,c){var d=function(){function a(){this._loggers=[],this._loggers.push(c)}return a.prototype.log=function(a){_.forEach(this._loggers,function(b){b.log(a)})},a.prototype.logError=function(a,b){_.forEach(this._loggers,function(c){c.logError(a,b)})},a}(),e=new d;return e}),define("nemesis.util/debug/verifier",["require","exports","../logger/index"],function(a,b,c){var d,e=function(){function a(a,b){this._value=a,this._name=b}return a.prototype.isDefined=function(){return"undefined"==typeof this._value&&c.logError(this._getMsg("Parameter [{name}, {value}] is undefined")),this},a.prototype.isNotEmpty=function(){return"undefined"!=typeof this._value.length&&0==this._value.length&&c.logError(this._getMsg("Parameter [{name}, {value}] is empty.")),this},a.prototype.isGreaterThan=function(a){return this._value<=a&&c.logError(this._getMsg("Parameter [{name}, {value}] is greater than ["+a+"]")),this},a.prototype.isLessThan=function(a){return this._value>=a&&c.logError(this._getMsg("Parameter [{name}, {value}] is less than ["+a+"]")),this},a.prototype._getMsg=function(a){return a.replace("{name}",this._name).replace("{value}",this._value)},a}();return function(a){function b(a,b){return new e(a,b)}a.that=b}(d||(d={})),d}),define("nemesis.render3D/texture",["require","exports","./glContext","../nemesis.util/debug/verifier"],function(a,b,c,d){var e=function(){function a(a){this._img=a,this._tex=c.createTexture(),this.loaded()?this._handleLoadedImage():this._img.onload=this._handleLoadedImage()}return a.prototype.loaded=function(){return this._img.complete?!0:!!("undefined"==typeof this._img.naturalWidth||this._img.naturalWidth>0)},a.prototype.activate=function(a){a="undefined"==typeof a?c.TEXTURE0:a,d.that(a,"texNumber").isGreaterThan(-1).isLessThan(32),c.activeTexture(a),c.bindTexture(c.TEXTURE_2D,this._tex)},a.prototype._handleLoadedImage=function(){c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,1),c.bindTexture(c.TEXTURE_2D,this._tex),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,this._img),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST_MIPMAP_LINEAR),c.generateMipmap(c.TEXTURE_2D),c.bindTexture(c.TEXTURE_2D,null)},a}();return e}),define("nemesis.render3D/renderObject",["require","exports","./glContext","../math/index","../nemesis.util/debug/verifier"],function(a,b,c,d,e){var f=function(){function a(a,b,c){this.attrib=a,this.size=b,this.buf=c}return a}(),g=function(){function a(a){this._attribs=[],this._shaderProgram=a,this._modelMat=d.mat4.create(),this._mvp=d.mat4.create()}return a.prototype.modelMatrix=function(a){return a&&d.mat4.copy(this._modelMat,a),d.mat4.clone(this._modelMat)},a.prototype.camera=function(a){return a&&(this._camera=a),this._camera},a.prototype.texture=function(a){return a&&(this._texture=a),this._texture},a.prototype.render=function(){c.useProgram(this._shaderProgram),this.setMatrix4("mvp",d.mat4.mul(this._mvp,this._camera.projectionView(),this._modelMat)),this._texture&&this._texture.loaded()&&this._texture.activate(),this._attribs.forEach(function(a){c.bindBuffer(c.ARRAY_BUFFER,a.buf),c.vertexAttribPointer(a.attrib,a.size,c.FLOAT,!1,0,0)}),c.drawElements(c.TRIANGLES,this._vertexes,c.UNSIGNED_SHORT,0)},a.prototype.dispose=function(){this._attribs.forEach(function(a){c.deleteBuffer(a.buf)})},a.prototype.setVertexes=function(a){e.that(a,"vertexes").isDefined().isNotEmpty();var b=c.createBuffer();c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,b),c.bufferData(c.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),c.STATIC_DRAW),this._vertexes=a.length},a.prototype.enableAttrib=function(a,b,d){e.that(a,"atttibName").isDefined(),e.that(b,"size").isDefined().isGreaterThan(0),e.that(d,"data").isDefined().isNotEmpty();var g=c.getAttribLocation(this._shaderProgram,a);c.enableVertexAttribArray(g);var h=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,h),c.bufferData(c.ARRAY_BUFFER,new Float32Array(d),c.STATIC_DRAW),this._attribs.push(new f(g,b,h))},a.prototype.setMatrix4=function(a,b){e.that(a,"uniName").isDefined(),e.that(b,"value").isDefined().isNotEmpty(),c.useProgram(this._shaderProgram);var d=c.getUniformLocation(this._shaderProgram,a);c.uniformMatrix4fv(d,!1,b)},a.prototype.setVector3=function(a,b){e.that(a,"uniName").isDefined(),e.that(b,"value").isDefined().isNotEmpty(),c.useProgram(this._shaderProgram);var d=c.getUniformLocation(this._shaderProgram,a);c.uniform3f(d,b[0],b[1],b[2])},a}();return g}),define("nemesis.render3D/index",["require","exports","./glContext","./nemesis.shaders","./render","./camera","./texture","./renderObject"],function(a,b,c,d,e,f,g,h){b.GL=c,b.shaders=d,b.render=e,b.camera=f,b.texture=g,b.renderObject=h});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("nemesis",["require","exports","./eventObject","./nemesis.input/index","./math/index","./nemesis.render3D/index","./canvas","./config"],function(a,b,c,d,e,f,g,h){var i=function(a){function b(){a.call(this),this.input=d,this.math=e,this.rendering=f,this.canvas=g,this.config=h,this.registerEvent("update"),this.registerEvent("render")}return __extends(b,a),b.prototype.run=function(a){var b=this;f.render.init();var c=function(d){b.emit("update",d,a),f.render.begin(),b.emit("render",d,a),f.render.end(),window.requestAnimationFrame(c)};window.requestAnimationFrame(c)},b}(c),j=new i;return j});